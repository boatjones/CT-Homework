---
title: "Stats in R Assignment"
author: "Alex Lucchesi"
date: "2023/05/30"
output: html_document
---

## Assignment

For today's assignment, you will be given a blank notebook and a link to the [Call of Duty Dataset](https://www.kaggle.com/datasets/beridzeg45/call-of-duty-reviews) You will need to fill out the notebook and create your own code chunks to run code. Remember that we use this code without any quotation marks to create a code chunk: '`{r} '` \### Your Goal:

To receive credit for today's assignment, you will need to:

-   Import the dataset
-   Load the dataset into a tibble
-   Mutate a new column
-   Create a hypothesis regarding your data and communicate that hypothesis in a scientific method.
-   Create a notebook that has markdown cells, explaining your code and process/thoughts. **Your markdown should be well thought out and reflect a thorough analysis.**
-   Clean the data
-   Explore the data (include visualizations)
-   Create a statistical test and communicate the results

## I. Import and Clean the Data

```{r}
# load packages
library(tidyverse, dplyr)
```

```{r}
# read csv to df
call_reviews <- read.csv('data/CallOfDutyReviews.csv')
call_reviews
```

```{r}
class(call_reviews)
```

```{r}
# class(df)
tbl_reviews <- as.tibble(call_reviews)
view(tbl_reviews)
```

```{r}
# rename columns function
rename_cols <- function(x) {
  # retrieve column names
  names(x) <- names(x) %>% str_replace_all("\\.", "_") %>% tolower()
  return(x)
}
```

```{r}
# use function to rename columns
cod_tbl <- rename_cols(tbl_reviews)
cod_tbl
```

```{r}
# check for missing values
sum(is.na(cod_tbl))
```

```{r}
class(cod_tbl)
```

```{r}
cod_tbl <- cod_tbl %>%
  drop_na()

view(cod_tbl)
```

```{r}
sum(is.na(cod_tbl))
```

```{r}
cod_tbl <- cod_tbl %>%
  filter(platform != "")

cod_tbl
```

```{r}
# mutate a new column
cod_tbl <- cod_tbl %>%
  mutate(cod_tbl, avg_score = (critic_compound_score + user_compound_score)/2)
cod_tbl
```

```{r}

```

### Hypotheses:

-   Ho There is no real difference between the critic and user scores
-   Ha There is a significant difference between the critic's score and the user score

## II. Visualization

```{r}
# a histogram of user ratings

avg_usr_rating <- mean(cod_tbl$user_compound_score)

ggplot(cod_tbl) + 
  geom_histogram(binwidth = 0.1, aes(x= user_compound_score), fill = 'blue', color='black') +
  geom_vline(xintercept = avg_usr_rating, color = 'green', linetype = 'dashed') + 
  labs(title = "Distribution of User Ratings", x = 'User Rating', y = 'Frequency')
```

```{r}
mean(cod_tbl$critic_compound_score)
```

```{r}
avg_critic_rating <- mean(cod_tbl$critic_compound_score)

ggplot(cod_tbl) + 
  geom_histogram(binwidth = 0.1, aes(x= critic_compound_score), fill = 'red', color='black') +
  geom_vline(xintercept = avg_usr_rating, color = 'orange', linetype = 'dashed') + 
  labs(title = "Distribution of Critic Ratings", x = 'Critic Rating', y = 'Frequency')
```

```{r}
avg_critic_rating <- mean(cod_tbl$critic_compound_score)
avg_usr_rating <- mean(cod_tbl$user_compound_score)

ggplot(cod_tbl) +
  geom_histogram(binwidth = 0.1, aes(x = critic_compound_score), fill = 'red', color='black', alpha = 0.6) +
  geom_histogram(binwidth = 0.1, aes(x = user_compound_score), fill = 'blue', color = 'black', alpha = 0.6) +
  geom_vline(xintercept = avg_usr_rating, color = 'green', linetype = 'dashed') +
  geom_vline(xintercept = avg_critic_rating, color = 'orange', linetype = 'dashed') +
  labs(title='Distribution of Critic and User Ratings', x = 'Rating', y = 'Frequency')

```

```{r}
ggplot(cod_tbl) +
  geom_boxplot(aes(x = release_year, y = user_compound_score), fill = "blue") +
  labs(title = "Box Plot of User Scores Over Time", x = "Release Year", y = "User Score")
```

```{r}
ggplot(cod_tbl) +
  geom_boxplot(aes(x = release_year, y = critic_compound_score), fill = "red") +
  labs(title = "Box Plot of Critic Scores Over Time", x = "Release Year", y = "Critic Score")
```

```{r}
ggplot(cod_tbl) +
  geom_point(aes(x = user_compound_score, y = critic_compound_score), color = 'purple') +
  labs(title = "Comparison of User and Critic Scores", x = "User Score", y = "Critic Score")
```

```{r}

```

### III. Statistical Testing

-   If the p-value is less than your chosen significance level (e.g., p \< 0.05), you can reject the null hypothesis.
-   Rejecting the null hypothesis would mean that there is a significant difference in means between user scores and critic scores, even though the correlation is weak.
-   Keep in mind that a weak correlation does not preclude the possibility of a significant difference in means.

t-test to compare two groups

```{r}
# perform a t-test
t.test(cod_tbl$user_compound_score, cod_tbl$critic_compound_score)
```

### Interpretation

The t-test suggests that there is some evidence against the null hypothesis (p-value = 0.05508). The alternative hypothesis suggests that the true difference in means is not equal to 0, indicating that there may be a signifanct difference between user_compound_score and critic_compound_score. HOWEVER, the evidence is not exrtremely strong, as the p-value is slightly above the significance level of 0.05.

The confidence interval indicates that the true difference in means could lie between approximately -0.1132 and 0.0012, which includes 0. This suggests some uncertainty about the exact difference in means.

In summary, the t-test provides evidence of a potential difference in means, but the result is not highly significant, and there is some degree of uncertainty about the exact difference in means. Therefore, we fail to reject the null hypothesis.

```{r}
# perform a Chi-Squared test
# create a contingency table
contingency_table <- table(cod_tbl$user_compound_score, cod_tbl$critic_compound_score)

# perform a Chi-Squared test
chisq_result <-chisq.test(contingency_table)

print(chisq_result)
```

```{r}

```
